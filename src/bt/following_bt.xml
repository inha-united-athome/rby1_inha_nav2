<root main_tree_to_execute="MainTree">
  <BehaviorTree ID="MainTree">
    <RecoveryNode number_of_retries="6" name="NavigateRecovery">
      <PipelineSequence name="NavigateWithReplanning">
        <RateController hz="0.5">
          <GoalUpdater input_goal="{goal}" output_goal="{updated_goal}">
            <Sequence>
              <ComputePathToPose goal="{updated_goal}" path="{path}" planner_id="GridBased"/>
              <TruncatePath distance="0.4" input_path="{path}" output_path="{truncated_path}"/>
            </Sequence>
          </GoalUpdater>
        </RateController>

        <KeepRunningUntilFailure>
          <FollowPath path="{truncated_path}" controller_id="FollowPath"/>
        </KeepRunningUntilFailure>
      </PipelineSequence>

      <ReactiveFallback name="RecoveryFallback">
        <GoalReached/>
        <Sequence name="RecoveryActions">
          <ClearEntireCostmap service_name="global_costmap/clear_entirely_global_costmap" name="ClearGlobalCostmap-R"/>
          <ClearEntireCostmap service_name="local_costmap/clear_entirely_local_costmap" name="ClearLocalCostmap-R"/>
        </Sequence>
      </ReactiveFallback>
    </RecoveryNode>
  </BehaviorTree>
</root>
